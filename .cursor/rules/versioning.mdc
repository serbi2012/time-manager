---
description: 업무 시간 관리 프로젝트의 버저닝 전략 및 릴리즈 가이드라인
globs:
alwaysApply: false
---

# 버저닝 전략 (Versioning Strategy)

## 버전 형식

**Semantic Versioning (SemVer)** 을 따릅니다.

```
MAJOR.MINOR.PATCH
예: 1.2.3
```

### 버전 번호 규칙

| 구분  | 설명                                                           | 예시          |
| ----- | -------------------------------------------------------------- | ------------- |
| MAJOR | 데이터 구조 변경, 핵심 기능 동작 방식 변경 (마이그레이션 필요) | 1.0.0 → 2.0.0 |
| MINOR | 새로운 페이지/라우트 추가, 독립적인 대형 기능 모듈 추가        | 1.0.0 → 1.1.0 |
| PATCH | 버그 수정, 기존 기능 개선/확장, UI/UX 개선, 단축키 추가        | 1.0.0 → 1.0.1 |

---

## 버전 변경 기준 (엄격 적용)

### MAJOR 버전 (X.0.0) - 호환성이 깨지는 변경

**반드시 아래 조건 중 하나 이상 해당할 때만 증가:**

-   LocalStorage 데이터 구조 변경 (기존 데이터 마이그레이션 필요)
-   Firebase/Firestore 스키마 변경 (기존 데이터 마이그레이션 필요)
-   핵심 기능의 동작 방식이 근본적으로 변경
-   기존 사용자가 반드시 조치를 취해야 하는 변경

**MAJOR가 아닌 경우:**

-   새 기능 추가 (기존 데이터에 영향 없음) → MINOR 또는 PATCH
-   UI 전면 개편 (데이터 구조 변경 없음) → PATCH

### MINOR 버전 (x.Y.0) - 새로운 독립 모듈 추가

**반드시 아래 조건 중 하나 이상 해당할 때만 증가:**

-   새로운 페이지/라우트 추가 (예: `/suggestions`, `/reports`)
-   독립적인 대형 기능 모듈 추가 (여러 컴포넌트로 구성된 완전한 기능)
-   새로운 Firebase Collection 추가

**MINOR가 아닌 경우 (→ PATCH로 처리):**

-   기존 페이지 내 새 기능 추가 → PATCH
-   기존 컴포넌트 기능 확장/개선 → PATCH
-   새 단축키, 새 옵션, 새 설정 추가 → PATCH
-   드래그앤드롭, 리사이즈 등 상호작용 추가 → PATCH

### PATCH 버전 (x.y.Z) - 그 외 모든 변경

**다음 모든 경우에 PATCH 증가:**

-   버그 수정
-   기존 기능 개선 및 확장
-   기존 페이지 내 소규모 기능 추가
-   UI/UX 개선 (레이아웃, 스타일, 애니메이션)
-   단축키 추가/변경
-   성능 최적화
-   의존성 업데이트
-   접근성 개선
-   반응형 디자인 개선
-   문서 수정

---

## 버전 결정 플로우차트

```
변경 사항 발생
    │
    ▼
기존 데이터 마이그레이션 필요? ──Yes──▶ MAJOR
    │
    No
    ▼
새로운 페이지/라우트 추가? ──Yes──▶ MINOR
    │
    No
    ▼
독립적인 대형 기능 모듈 추가? ──Yes──▶ MINOR
    │
    No
    ▼
PATCH
```

---

## 릴리즈 프로세스

### 1. 버전 업데이트 위치

버전은 다음 파일들에서 관리됩니다:

```
package.json          → version 필드
src/constants/changelog.ts → CURRENT_VERSION 상수
```

### 2. CHANGELOG 업데이트

`src/constants/changelog.ts` 파일에 변경 내역을 기록합니다:

```typescript
export const CHANGELOG: ChangelogEntry[] = [
    {
        version: "1.1.0",
        date: "2026-01-20",
        title: "새로운 기능 제목",
        changes: [
            { type: "feature", description: "새로운 기능 설명" },
            { type: "fix", description: "버그 수정 설명" },
            { type: "improvement", description: "개선 사항 설명" },
        ],
    },
    // ... 이전 버전들
];
```

### 3. 변경 타입 (Change Type)

| 타입        | 설명                 | 이모지 |
| ----------- | -------------------- | ------ |
| feature     | 새로운 기능          | ✨     |
| fix         | 버그 수정            | 🐛     |
| improvement | 기존 기능 개선       | 💪     |
| breaking    | 호환성이 깨지는 변경 | ⚠️     |
| deprecation | 기능 지원 중단 예고  | 📢     |
| security    | 보안 관련 수정       | 🔒     |
| performance | 성능 개선            | ⚡     |
| style       | UI/스타일 변경       | 🎨     |
| docs        | 문서 변경            | 📝     |

### 4. CHANGELOG 제외 대상

다음 항목은 CHANGELOG에 기록하지 않습니다:

-   **관리자 기능** (`/admin` 페이지, `AdminSessionGrid.tsx` 등)
    -   내부 디버깅/데이터 관리 용도
    -   일반 사용자에게 노출되지 않는 기능

---

## 릴리즈 체크리스트

### 릴리즈 전 (필수)

> ⚠️ **중요**: 버전 업데이트 및 CHANGELOG 갱신 전에 반드시 테스트를 실행하세요!

```bash
# 1. 테스트 실행 (필수 - 가장 먼저!)
pnpm test:run                    # 전체 테스트
pnpm test:run src/test/unit      # 유닛 테스트만

# 2. 린트 검사
pnpm lint

# 3. 빌드 확인
pnpm build
```

-   [ ] **모든 테스트 통과** (`pnpm test:run`) ← 필수! 실패 시 수정 후 진행
-   [ ] 린트 에러 없음 (`pnpm lint`)
-   [ ] 빌드 성공 (`pnpm build`)
-   [ ] CHANGELOG 업데이트 완료
-   [ ] package.json 버전 업데이트

> **현재 테스트 현황**: 27개 파일, 504개 테스트

### 테스트 실패 시 대응

1. 테스트 실패 원인 분석
    - **기능이 변경**되었는데 테스트가 옛날 것인 경우 → 테스트 케이스 수정
    - **버그가 발생**한 경우 → 코드 수정
2. 수정 후 테스트 재실행
3. 모든 테스트 통과 확인 후 버전 업데이트 진행

### 릴리즈 후

-   [ ] Git 태그 생성 (`git tag v1.0.0`)
-   [ ] GitHub 릴리즈 노트 작성 (선택)
-   [ ] Vercel 배포 확인

---

## Git 태그 규칙

```bash
# 태그 형식
v{MAJOR}.{MINOR}.{PATCH}

# 예시
git tag v1.0.0
git tag v1.1.0
git tag v1.1.1

# 태그 푸시
git push origin v1.0.0
```

---

## 버전 히스토리 관리

### CHANGELOG 파일 위치

```
src/constants/changelog.ts
```

### CHANGELOG 표시 위치

-   상단 헤더의 버전 버튼 클릭 시 모달로 표시
-   최신 버전이 상단에 위치

---

## 첫 번째 안정 버전

### v1.0.0 (2026-01-19)

초기 안정 버전으로, 다음 기능들이 포함됩니다:

**핵심 기능:**

-   실시간 타이머 기반 작업 시간 측정
-   작업 기록 관리 (추가/수정/삭제/완료)
-   작업 프리셋 (템플릿) 관리
-   일간 간트차트 시각화
-   주간 일정 조회 및 복사
-   Firebase 클라우드 동기화
-   다중 탭 타이머 동기화
-   단축키 지원

---

## 예시: 버전 업데이트 시나리오

### PATCH 예시 (x.y.Z)

```
현재 버전: 1.2.0
수정 내용: 타이머가 간헐적으로 멈추는 버그 수정
새 버전: 1.2.1
```

```
현재 버전: 1.2.1
수정 내용: 간트차트 드래그 리사이즈 기능 추가
새 버전: 1.2.2 (기존 페이지 내 기능 개선)
```

```
현재 버전: 1.2.2
수정 내용: F8 단축키 추가, 모바일 반응형 개선
새 버전: 1.2.3
```

```
현재 버전: 1.2.3
수정 내용: 게스트 모드 지원 (로그인 없이 사용 가능)
새 버전: 1.2.4 (기존 기능 확장, 새 페이지 아님)
```

### MINOR 예시 (x.Y.0)

```
현재 버전: 1.2.4
수정 내용: 건의사항 게시판 페이지 추가 (/suggestions)
새 버전: 1.3.0 (새 페이지/라우트 추가)
```

```
현재 버전: 1.3.0
수정 내용: 월간 리포트 페이지 추가 (/reports)
새 버전: 1.4.0 (새 페이지/라우트 추가)
```

### MAJOR 예시 (X.0.0)

```
현재 버전: 1.4.0
수정 내용: WorkRecord에 새 필수 필드 추가 (기존 데이터 마이그레이션 필요)
새 버전: 2.0.0
```

```
현재 버전: 2.0.0
수정 내용: Firebase에서 Supabase로 마이그레이션
새 버전: 3.0.0
```
